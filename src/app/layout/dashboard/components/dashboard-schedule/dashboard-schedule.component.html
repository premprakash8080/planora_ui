<div class="dashboard-schedule-wrapper">
  <!-- <div class="schedule-header">
    <div class="header-content">
      <h2 class="header-title">View Projects</h2>
      <p class="header-subtitle">Manage and track all your projects</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" (click)="loadProjects()" [disabled]="loading">
        <mat-icon>refresh</mat-icon>
        Refresh
      </button>
    </div>
  </div> -->

  <div class="flex flex-wrap md:-m-16c -m-8c cus-h-vh">
    <div class="md:p-16c p-8c h-full mt-8c w-full rounded-lg relative">
      <!-- Loading State -->
      <div
        *ngIf="loading"
        class="flex items-center justify-center cus-schedule-card-height"
      >
        <mat-spinner diameter="40"></mat-spinner>
        <span class="ml-4" style="color: var(--color-text-body)"
          >Loading projects...</span
        >
      </div>

      <!-- Error State -->
      <div
        *ngIf="error && !loading"
        class="flex items-center justify-center cus-schedule-card-height"
      >
        <div class="text-center">
          <mat-icon class="text-6xl mb-4" style="color: var(--color-danger)"
            >error_outline</mat-icon
          >
          <p class="mb-4" style="color: var(--color-text-body)">{{ error }}</p>
          <button mat-raised-button color="primary" (click)="loadProjects()">
            Try Again
          </button>
        </div>
      </div>

      <!-- Projects List -->
      <div
        *ngIf="!loading && !error"
        class="flex flex-wrap overflow-auto items-start cus-schedule-card-height"
      >
        <!-- Empty State -->
        <div
          *ngIf="projects.length === 0"
          class="flex items-center justify-center w-full cus-schedule-card-height"
        >
          <div class="text-center">
            <mat-icon class="text-6xl mb-4" style="color: var(--color-muted)"
              >folder_open</mat-icon
            >
            <p class="text-lg mb-2" style="color: var(--color-text-body)">
              No projects found
            </p>
            <p style="color: var(--color-text-subtle)">
              Create your first project to get started
            </p>
          </div>
        </div>

        <!-- Project Cards -->
        <div
          *ngFor="let project of projects; trackBy: trackByProjectId"
          (click)="openSideBar(project)"
          class="project-item w-full mb-4"
        >
          <div class="project-item__body">
            <!-- Project Info -->
            <div class="project-item__info">
              <!-- Project Avatar/Icon -->
              <div
                class="project-item__avatar"
                [style.backgroundColor]="getProjectColor(project) + '20'"
              >
                <div
                  class="w-full h-full flex items-center justify-center rounded-lg"
                  [style.color]="getProjectColor(project)"
                >
                  <mat-icon class="text-4xl">{{
                    project.is_favorite ? "star" : "folder"
                  }}</mat-icon>
                </div>
              </div>

              <!-- Project Details -->
              <div class="project-item__details">
                <div class="project-item__title-row">
                  <h3 class="project-item__title">{{ project.name }}</h3>
                  <span
                    class="status-chip"
                    [style.backgroundColor]="
                      getProjectStatusColor(project) + '20'
                    "
                    [style.color]="getProjectStatusColor(project)"
                  >
                    {{ getProjectStatus(project) }}
                  </span>
                  <mat-icon *ngIf="project.is_favorite" class="text-yellow-500"
                    >star</mat-icon
                  >
                </div>

                <p
                  class="text-sm mb-2"
                  *ngIf="project.description"
                  style="color: var(--color-text-body)"
                >
                  {{ project.description }}
                </p>

                <div class="project-item__tags">
                  <span class="project-tag">
                    <mat-icon>people</mat-icon>
                    {{ getMemberCount(project) }}
                    {{ getMemberCount(project) === 1 ? "member" : "members" }}
                  </span>
                  <span class="project-tag" *ngIf="project.due_date">
                    <mat-icon>event</mat-icon>
                    {{ project.due_date | date : "MMM d, y" }}
                  </span>
                  <span class="project-tag" *ngIf="project.creator">
                    <mat-icon>person</mat-icon>
                    {{ project.creator.full_name }}
                  </span>
                </div>
              </div>
            </div>

            <!-- Project Actions -->
            <div class="project-item__actions">
              <button
                mat-stroked-button
                color="primary"
                (click)="openSideBar(); $event.stopPropagation()"
              >
                <mat-icon>visibility</mat-icon>
                View
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <mat-sidenav disableClose="false" backdropDisable="true" mode="over" class="3xl:p-40 xl:p-24 sm:p-16 p-8c max-w-[711px] w-full side-bar-height"
  position="end" #snavForSchedule (opened)="events.push('open!')" (closed)="events.push('close!')"
  [opened]="isSidenavOpen">
  <mat-nav-list class="h-full">
    <app-schedule-detail (closeScheduleSidebarEvent)="closeSidebar()"></app-schedule-detail>
  </mat-nav-list>
</mat-sidenav> -->

<!-- <mat-drawer-container class="container">
  <mat-drawer class="3xl:p-40c xl:p-24c sm:p-16c p-8c  max-w-[711px] md:w-full w-10/12 side-bar-height"  position="end" #snavForSchedule mode="over">
    <app-schedule-detail (closeScheduleSidebarEvent)="closeSidebar()"></app-schedule-detail>
  </mat-drawer>
  <mat-drawer-content>
  </mat-drawer-content>
</mat-drawer-container> -->

<mat-sidenav-container class="container">
  <mat-sidenav
    class="3xl:p-40c xl:p-24c sm:p-16c p-8c max-w-[711px] md:w-full w-10/12 side-bar-height"
    position="end"
    #snavForSchedule
    mode="over"
  >
    <app-schedule-detail
      [project]="selectedProject"
      (closeScheduleSidebarEvent)="closeSidebar()"
    ></app-schedule-detail>
  </mat-sidenav>
  <mat-sidenav-content> </mat-sidenav-content>
</mat-sidenav-container>

<mat-sidenav-container class="container">
  <mat-sidenav
    [opened]="isOpen$ | async"
    class="xxl:p-24c sm:p-16c p-8c sm:max-w-[408px] max-w-[300px] w-full cmn-sidebar-height right-side-bar h-screen"
    position="end"
    #snav
    mode="over"
  >
    <app-profile (closeSidebarEvent)="closeSidebar()"></app-profile>
  </mat-sidenav>
  <mat-sidenav-content> </mat-sidenav-content>
</mat-sidenav-container>

<mat-sidenav-container class="container">
  <mat-sidenav
    [opened]="isOpenNotificationBar$ | async"
    class="xxl:p-24c sm:p-16c p-8c sm:max-w-[408px] max-w-[300px] w-full cmn-sidebar-height right-side-bar h-screen"
    position="end"
    #snavForNotification
    mode="over"
  >
    <app-notification></app-notification>
  </mat-sidenav>
  <mat-sidenav-content> </mat-sidenav-content>
</mat-sidenav-container>
