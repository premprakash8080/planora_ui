<div class="schedule-detail-container">
  <!-- Header -->
  <div class="schedule-header">
    <div class="header-content">
      <h2 class="header-title">{{ project?.name || 'Project Details' }}</h2>
      <button 
        mat-icon-button 
        (click)="cancel()" 
        class="close-btn"
        matTooltip="Close"
      >
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading && !project">
    <mat-progress-spinner diameter="40" mode="indeterminate"></mat-progress-spinner>
    <p>Loading project details...</p>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error && !loading">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <p>{{ error }}</p>
    <button mat-button color="primary" (click)="loadProjectDetails()">Retry</button>
  </div>

  <!-- Main Content -->
  <div class="project-details" *ngIf="project && !loading">
    <!-- ────────────────────── LEFT COLUMN ────────────────────── -->
    <div class="left-column">
      <!-- Project description -->
      <section class="section">
        <div class="section-header">
          <h2 class="section-title">Project description</h2>
        </div>
        <p class="section-subtitle">What's this project about?</p>
        
        <div>
          <p class="description-text" *ngIf="project.description; else emptyDesc">
            {{ project.description }}
          </p>
          <ng-template #emptyDesc>
            <p class="empty-text">
              <mat-icon>add_circle_outline</mat-icon>
              No description available
            </p>
          </ng-template>
        </div>
      </section>

      <!-- Project members -->
      <section class="section">
        <div class="section-header">
          <h2 class="section-title">Project members</h2>
        </div>
        <div class="members-list">
          <div class="member" *ngFor="let member of projectMembers; trackBy: trackByMemberId">
            <app-avatar 
              size="sm" 
              [initials]="member.initials" 
              [color]="member.color"
            ></app-avatar>
            <div class="member-info">
              <span class="member-name">{{ member.name }}</span>
              <span class="member-role" *ngIf="member.role">{{ member.role }}</span>
            </div>
          </div>
          <div class="empty-members" *ngIf="projectMembers.length === 0">
            <p class="empty-text">
              <mat-icon>people_outline</mat-icon>
              No members assigned to this project.
            </p>
          </div>
        </div>
      </section>

      <!-- Project information -->
      <section class="section">
        <h2 class="section-title">Project information</h2>
        <div class="info-list">
          <div class="info-item" *ngIf="project.created_at">
            <div class="info-label">
              <mat-icon>calendar_today</mat-icon>
              <span>Created</span>
            </div>
            <div class="info-value">
              {{ project.created_at | date: 'MMM d, y' }}
            </div>
          </div>
          <div class="info-item" *ngIf="project.updated_at">
            <div class="info-label">
              <mat-icon>update</mat-icon>
              <span>Last updated</span>
            </div>
            <div class="info-value">
              {{ project.updated_at | date: 'MMM d, y' }}
            </div>
          </div>
          <div class="info-item" *ngIf="project.creator">
            <div class="info-label">
              <mat-icon>person</mat-icon>
              <span>Created by</span>
            </div>
            <div class="info-value">
              {{ project.creator.full_name }}
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- ────────────────────── RIGHT COLUMN ────────────────────── -->
    <div class="right-column">
      <!-- Status -->
      <section class="status-section">
        <h2 class="section-title">Project status</h2>

        <div class="status-display">
          <div class="status-badge" [class]="'status-' + (project.status || 'active')">
            <span class="status-dot"></span>
            <span class="status-text">{{ getStatusLabel(project.status) }}</span>
          </div>
        </div>

        <!-- Due date -->
        <div class="due-date-section">
          <div class="due-date-header">
            <h3 class="due-date-label">Due date</h3>
          </div>

          <div class="due-date" *ngIf="project.due_date; else noDueDate">
            <mat-icon>event</mat-icon> 
            <span>{{ project.due_date | date: 'MMM d, y' }}</span>
          </div>
          <ng-template #noDueDate>
            <div class="due-date empty">
              <mat-icon>event</mat-icon> 
              <span>No due date set</span>
            </div>
          </ng-template>
        </div>
      </section>

      <!-- Project metadata -->
      <section class="section">
        <h2 class="section-title">Project metadata</h2>
        <div class="metadata-list">
          <div class="metadata-item" *ngIf="project.is_favorite !== undefined">
            <mat-icon [class.favorite]="project.is_favorite">
              {{ project.is_favorite ? 'star' : 'star_border' }}
            </mat-icon>
            <span>{{ project.is_favorite ? 'Favorite project' : 'Not favorited' }}</span>
          </div>
          <div class="metadata-item" *ngIf="project.is_archived !== undefined">
            <mat-icon [class.archived]="project.is_archived">
              {{ project.is_archived ? 'archive' : 'unarchive' }}
            </mat-icon>
            <span>{{ project.is_archived ? 'Archived' : 'Active' }}</span>
          </div>
          <div class="metadata-item" *ngIf="project.team_id">
            <mat-icon>group</mat-icon>
            <span>Team ID: {{ project.team_id }}</span>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>
