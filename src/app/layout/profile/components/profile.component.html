<div class="page-container profile-page">
  <app-page-title
    title="My Profile"
    description="View and manage your profile information"
  >
    <ng-container pageActions>
      <app-button variant="primary" (pressed)="onEdit()">
        <mat-icon>edit</mat-icon>
        Edit Profile
      </app-button>
    </ng-container>
  </app-page-title>

  <div class="profile-content" *ngIf="user$ | async as user; else loadingTemplate">
    <app-card padding="lg" class="profile-card">
      <div class="profile-header">
        <app-avatar
          [src]="user.avatar_url"
          [initials]="user.initials || getInitials(user.full_name)"
          [color]="user.avatar_color"
          [alt]="user.full_name"
          size="lg"
        ></app-avatar>
        
        <div class="profile-info">
          <h2 class="profile-name">{{ user.full_name }}</h2>
          <p class="profile-email">{{ user.email }}</p>
          <span class="profile-status" [class]="'status-' + user.status">
            {{ user.status | titlecase }}
          </span>
        </div>
      </div>
    </app-card>

    <app-card padding="lg" class="profile-details-card">
      <h3 class="card-title">Personal Information</h3>
      <div class="detail-list">
        <div class="detail-item">
          <mat-icon class="detail-icon">person</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Full Name</span>
            <span class="detail-value">{{ user.full_name }}</span>
          </div>
        </div>
        <div class="detail-item">
          <mat-icon class="detail-icon">email</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Email</span>
            <span class="detail-value">{{ user.email }}</span>
          </div>
        </div>
        <div class="detail-item" *ngIf="user.initials">
          <mat-icon class="detail-icon">badge</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Initials</span>
            <span class="detail-value">{{ user.initials }}</span>
          </div>
        </div>
        <div class="detail-item">
          <mat-icon class="detail-icon">verified</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Status</span>
            <span class="detail-value">{{ user.status | titlecase }}</span>
          </div>
        </div>
        <div class="detail-item" *ngIf="user.created_at">
          <mat-icon class="detail-icon">calendar_today</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Member Since</span>
            <span class="detail-value">{{ formatDate(user.created_at) }}</span>
          </div>
        </div>
        <div class="detail-item" *ngIf="user.updated_at">
          <mat-icon class="detail-icon">update</mat-icon>
          <div class="detail-content">
            <span class="detail-label">Last Updated</span>
            <span class="detail-value">{{ formatDate(user.updated_at) }}</span>
          </div>
        </div>
      </div>
    </app-card>
  </div>

  <!-- Loading Template -->
  <ng-template #loadingTemplate>
    <div class="loading-container">
      <mat-icon class="loading-icon">hourglass_empty</mat-icon>
      <p>Loading profile...</p>
    </div>
  </ng-template>

  <!-- No User Template -->
  <div *ngIf="(user$ | async) === null" class="no-user-container">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <h3>Profile Not Found</h3>
    <p>Unable to load your profile. Please try again later.</p>
  </div>
</div>
