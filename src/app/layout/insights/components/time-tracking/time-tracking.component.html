<div class="time-tracking-container">
  <!-- Page Header -->
  <div class="time-header">
    <div class="header-content">
      <h1 class="page-title">
        <mat-icon class="title-icon">schedule</mat-icon>
        Time Tracking
      </h1>
      <p class="page-subtitle">Track time spent on projects and tasks</p>
    </div>
  </div>

  <!-- Time Summary Cards -->
  <div class="summary-section">
    <div class="summary-grid">
      <mat-card class="summary-card">
        <mat-card-content>
          <div class="summary-content">
            <mat-icon class="summary-icon total">access_time</mat-icon>
            <div class="summary-info">
              <div class="summary-label">Total Hours This Week</div>
              <div class="summary-value">{{ totalHoursThisWeek.toFixed(1) }}h</div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-content>
          <div class="summary-content">
            <mat-icon class="summary-icon billable">attach_money</mat-icon>
            <div class="summary-info">
              <div class="summary-label">Billable Hours</div>
              <div class="summary-value billable">{{ totalBillableHours.toFixed(1) }}h</div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="summary-card">
        <mat-card-content>
          <div class="summary-content">
            <mat-icon class="summary-icon non-billable">timer_off</mat-icon>
            <div class="summary-info">
              <div class="summary-label">Non-Billable Hours</div>
              <div class="summary-value non-billable">{{ totalNonBillableHours.toFixed(1) }}h</div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Project Time Summary -->
  <div class="project-summary-section">
    <h2 class="section-title">
      <mat-icon class="section-icon">folder</mat-icon>
      Time by Project
    </h2>
    <div class="project-summary-grid">
      <mat-card *ngFor="let project of projectTimeSummary" class="project-card modern-card" [style.border-left-color]="project.color">
        <mat-card-content>
          <div class="project-header">
            <div class="project-icon-wrapper" [style.background-color]="project.color + '20'">
              <mat-icon [style.color]="project.color" class="project-icon">folder</mat-icon>
            </div>
            <div class="project-info">
              <h3 class="project-name">{{ project.projectName }}</h3>
              <div class="project-stats">
                <span class="stat-item">{{ project.tasksCount }} tasks</span>
              </div>
            </div>
          </div>
          <div class="project-time-details">
            <div class="time-detail">
              <span class="time-label">Total</span>
              <span class="time-value">{{ project.totalHours }}h</span>
            </div>
            <div class="time-detail">
              <span class="time-label">Billable</span>
              <span class="time-value billable">{{ project.billableHours }}h</span>
            </div>
            <div class="time-detail">
              <span class="time-label">Non-Billable</span>
              <span class="time-value non-billable">{{ project.nonBillableHours }}h</span>
            </div>
          </div>
          <div class="project-progress">
            <div class="progress-bar">
              <div class="progress-fill billable" 
                   [style.width.%]="(project.billableHours / project.totalHours) * 100"
                   [style.background-color]="project.color">
              </div>
              <div class="progress-fill non-billable" 
                   [style.width.%]="(project.nonBillableHours / project.totalHours) * 100"
                   style="background-color: #9e9e9e;">
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Daily Time Breakdown -->
  <div class="daily-breakdown-section">
    <h2 class="section-title">
      <mat-icon class="section-icon">calendar_today</mat-icon>
      Daily Time Breakdown
    </h2>
    <mat-card class="breakdown-card modern-card">
      <mat-card-content>
        <div class="breakdown-chart">
          <div *ngFor="let day of dailyTimeBreakdown" class="chart-day-wrapper">
            <div class="chart-bars">
              <div class="bar-container">
                <div class="bar-label">{{ day.day }}</div>
                <div class="bars-wrapper">
                  <div class="bar billable-bar" 
                       [style.height.%]="(day.billableHours / getMaxHours()) * 100"
                       [style.background]="'linear-gradient(to top, #4caf50, #66bb6a)'"
                       [matTooltip]="day.billableHours + 'h billable'">
                    <span class="bar-value" *ngIf="day.billableHours > 0">{{ day.billableHours }}h</span>
                  </div>
                  <div class="bar non-billable-bar" 
                       [style.height.%]="(day.nonBillableHours / getMaxHours()) * 100"
                       [style.background]="'linear-gradient(to top, #9e9e9e, #bdbdbd)'"
                       [matTooltip]="day.nonBillableHours + 'h non-billable'">
                    <span class="bar-value" *ngIf="day.nonBillableHours > 0">{{ day.nonBillableHours }}h</span>
                  </div>
                </div>
                <div class="bar-total">{{ day.hours }}h</div>
              </div>
            </div>
          </div>
        </div>
        <div class="breakdown-legend">
          <div class="legend-item">
            <div class="legend-color billable"></div>
            <span>Billable Hours</span>
          </div>
          <div class="legend-item">
            <div class="legend-color non-billable"></div>
            <span>Non-Billable Hours</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Time Entries Table -->
  <div class="time-entries-section">
    <h2 class="section-title">
      <mat-icon class="section-icon">list</mat-icon>
      Recent Time Entries
    </h2>
    <mat-card class="table-card modern-card">
      <mat-card-content>
        <div class="table-wrapper">
          <table mat-table [dataSource]="timeEntries" class="time-entries-table">
            
            <!-- Date Column -->
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">calendar_today</mat-icon>
                  Date
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <span class="date-text">{{ entry.date }}</span>
              </td>
            </ng-container>

            <!-- Project Column -->
            <ng-container matColumnDef="project">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">folder</mat-icon>
                  Project
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <div class="project-cell">
                  <mat-icon class="project-icon">folder</mat-icon>
                  <span>{{ entry.projectName }}</span>
                </div>
              </td>
            </ng-container>

            <!-- Task Column -->
            <ng-container matColumnDef="task">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">task</mat-icon>
                  Task
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <span class="task-text">{{ entry.taskName }}</span>
              </td>
            </ng-container>

            <!-- Time Column -->
            <ng-container matColumnDef="time">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">schedule</mat-icon>
                  Time
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <span class="time-text">{{ formatTime(entry.hours, entry.minutes) }}</span>
              </td>
            </ng-container>

            <!-- Billable Column -->
            <ng-container matColumnDef="billable">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">attach_money</mat-icon>
                  Billable
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <span class="billable-badge" [ngClass]="getBillableColor(entry.billable)">
                  <mat-icon class="badge-icon">{{ entry.billable ? 'check_circle' : 'cancel' }}</mat-icon>
                  {{ entry.billable ? 'Yes' : 'No' }}
                </span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                  <mat-icon class="header-icon">more_vert</mat-icon>
                  Actions
                </div>
              </th>
              <td mat-cell *matCellDef="let entry">
                <button mat-icon-button class="action-button" matTooltip="More options">
                  <mat-icon>more_vert</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>
          </table>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

